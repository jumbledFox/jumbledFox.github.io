<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="icon" type="image/x-icon" href="images/favicon.png">
    
        <link rel="stylesheet" href="css/style.css">
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/remarkable/1.7.1/remarkable.min.js"></script>

        <script src="scripts/main-stuff.js"></script>

        <script>

            window.addEventListener('load', 
                function() { 
                let loc = window.location;
                    if(loc.search[1] == "/") { // If we need to redirect
                        let decoded = loc.search.slice(1).split("&").map(function(s) {
                            return s.replace(/~and~/g, "&");
                        }).join((loc.search.includes("&")) ? "?" : "") + loc.hash;

                        console.log(decoded);

                        // Push the new URL to the history stack
                        window.history.pushState(decoded.slice(1), ``, decoded);

                        // Load page
                        loadPage(loc.pathname.slice(1));
                    } else {
                        // Load index
                        loadPage("index");
                    }

                }, false);

            const md = new Remarkable({
                html:true
            });

            // Loading pages
            function loadPage(filelocation) {
                fileLoc = "pages/" + filelocation + ".md";
                try { // TODO - Make this piece of shit work
                    $.get(fileLoc, function(data) {
                        $("#main").html(md.render(data));
                    });
                } catch (error) {
                    $.get("pages/404.md", function(data) {
                        $("#main").html(md.render(data));
                    });
                }

                [].forEach.call(document.getElementsByTagName("a"), (element) => {
                    element.addEventListener("click", (event) => {
                    event.preventDefault(); // Block the page from loading
                    alert(element.href); // Show an alert with the url in the href
                    });
                });
            }
            

        </script>
    </head>
    <body>
        <div id="fly-holder"></div>
        <div id="gradient"></div>

        <div id="centerer">
            <div></div>
            <div id="main">

            </div>
            <div></div>
        </div>
    </body>
</html>
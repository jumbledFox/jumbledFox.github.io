<html>
    <head>
        <link rel="stylesheet" href="css/style.css">
        <link rel="icon" type="image/x-icon" href="images/favicon.png">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script> <!-- GSAP - rainbow -->
        <script>
            gsap.to("html", {
                keyframes: {
                    "0%"  : { "--color-rainbow": "69 , 163, 229" },
                    "12%" : { "--color-rainbow": "51 , 204, 204" },
                    "25%" : { "--color-rainbow": "102, 191, 57 " },
                    "38%" : { "--color-rainbow": "255, 166, 2  " },
                    "50%" : { "--color-rainbow": "235, 103, 15 " },
                    "62%" : { "--color-rainbow": "255, 51 , 85 " },
                    "76%" : { "--color-rainbow": "134, 76 , 191" },
                    "100%": { "--color-rainbow": "69 , 163, 229" }
                },
                duration: 7,
                repeat: -1,
                ease: "none"
            });
        </script>
        <script src="https://cdn.jsdelivr.net/remarkable/1.7.1/remarkable.min.js"></script> <!-- Remarkable - markdown -->

        <script>
            // shamelessly stolen from https://github.com/rafgraph/spa-github-pages/blob/v6.0.0/index.html
            (function(l) {
                if (l.search[1] === '/' ) {
                var decoded = l.search.slice(1).split('&').map(function(s) { 
                    return s.replace(/~and~/g, '&')
                }).join('?');
                window.history.replaceState(null, null,
                    l.pathname.slice(0, -1) + decoded + l.hash
                );
                }
            }(window.location));

            let markdownfileLocation = "/markdownfiles" + ((window.location.pathname == "/") ? "index": window.location.pathname.replace(/\/$/, "")) + ".md";
            // Look for the markdown file
            fetch(window.location.origin  + markdownfileLocation).then(function(response) {
                
                let pagetorender = window.location.origin;

                // Possible responses
                switch(response.status) {
                    case 200:
                        // Found the file, so render it
                        pagetorender += markdownfileLocation;
                        break;
                    case 404:
                        // Didn't find the file, so render the 404 page
                        pagetorender += "/errorpages/404.md";
                        break;
                    default:
                        // Something else happened, so render the error page
                        pagetorender += "/errorpages/error.md";
                        break;
                }

                const md = new Remarkable({
                    html:true
                });

                console.log(pagetorender);
                fetch(pagetorender).then(function(response) {
                    response.text().then(function(text) {
                        document.getElementById("main").innerHTML = md.render(text);
                    });
                });


            });
        </script>
    </head>
    <body>
        <div id="gradient"></div>

        <div id="main"></div>
    </body>
</html>